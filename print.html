<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The CANtact Book</title>
        
        <meta name="robots" content="noindex" />
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="cantact-pro/users-guide.html"><strong aria-hidden="true">2.</strong> CANtact Pro User Guide</a></li><li class="chapter-item expanded "><a href="cantact/users-guide.html"><strong aria-hidden="true">3.</strong> CANtact User Guide</a></li><li class="chapter-item expanded "><a href="tools/software-tools.html"><strong aria-hidden="true">4.</strong> Software Tools</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="tools/cantact-cli.html"><strong aria-hidden="true">4.1.</strong> CANtact CLI</a></li><li class="chapter-item expanded "><a href="tools/socketcan.html"><strong aria-hidden="true">4.2.</strong> SocketCAN</a></li><li class="chapter-item expanded "><a href="tools/busmaster.html"><strong aria-hidden="true">4.3.</strong> BUSMASTER</a></li></ol></li><li class="chapter-item expanded "><a href="apis/apis.html"><strong aria-hidden="true">5.</strong> APIs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="apis/rust.html"><strong aria-hidden="true">5.1.</strong> Rust</a></li><li class="chapter-item expanded "><a href="apis/python.html"><strong aria-hidden="true">5.2.</strong> Python</a></li><li class="chapter-item expanded "><a href="apis/c.html"><strong aria-hidden="true">5.3.</strong> C / C++</a></li></ol></li><li class="chapter-item expanded "><a href="socketcan/socketcan.html"><strong aria-hidden="true">6.</strong> SocketCAN</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="socketcan/getting-socketcan.html"><strong aria-hidden="true">6.1.</strong> Getting SocketCAN</a></li><li class="chapter-item expanded "><a href="socketcan/hw-devices.html"><strong aria-hidden="true">6.2.</strong> Hardware Devices</a></li><li class="chapter-item expanded "><a href="socketcan/virtual-devices.html"><strong aria-hidden="true">6.3.</strong> Virtual Devices</a></li><li class="chapter-item expanded "><a href="socketcan/utilities.html"><strong aria-hidden="true">6.4.</strong> Utilities</a></li><li class="chapter-item expanded "><a href="socketcan/isotp.html"><strong aria-hidden="true">6.5.</strong> ISOTP</a></li></ol></li><li class="chapter-item expanded "><a href="hacking/hacking.html"><strong aria-hidden="true">7.</strong> Hacking</a></li><li class="chapter-item expanded "><a href="support/support.html"><strong aria-hidden="true">8.</strong> Support</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">The CANtact Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#introduction" id="introduction">Introduction</a></h1>
<p>This &quot;book&quot; provides documentation for the CANtact hardware devices and related hardware.
It also provides information on some device agnostic software tools including SocketCAN. </p>
<p>The content here is generated by <a href="https://github.com/rust-lang/mdBook">mdBook</a>, and the
source code is <a href="https://github.com/linklayer/cantact-book">available on Github</a>. 
If you find any issues with the information here, please create a Github issue 
(or even better, submit a pull request ðŸ˜‰).</p>
<h1><a class="header" href="#cantact-pro-user-guide" id="cantact-pro-user-guide">CANtact Pro User Guide</a></h1>
<p><img src="cantact-pro/cantact-pro.jpg" alt="CANtact Pro" /></p>
<p>CANtact Pro is <a href="https://www.crowdsupply.com/linklayer-labs/cantact-pro">available from CrowdSupply</a></p>
<h2><a class="header" href="#getting-started" id="getting-started">Getting Started</a></h2>
<p>Thank you for buying a CANtact Pro ðŸ™‚</p>
<p>To start using CANtact, connect it via USB. Before using, you should update to the latest 
firmware following the instructions in this document.</p>
<p>After updating, the device will work on Linux via SocketCAN. For details, see <a href="cantact-pro/../tools/socketcan.html">SocketCAN</a>. </p>
<p>On all platforms, you can install the CANtact CLI. For details, see <a href="cantact-pro/../tools/cantact-cli.html">CANtact CLI</a>.</p>
<p>For more information on software support, see <a href="cantact-pro/../tools/software-tools.html">Software Tools</a>.</p>
<h2><a class="header" href="#features--specifications" id="features--specifications">Features &amp; Specifications</a></h2>
<ul>
<li>2x CAN Interfaces
<ul>
<li>1x CAN/CAN-FD/SWCAN</li>
<li>1x CAN/CAN-FD</li>
</ul>
</li>
<li>High Speed USB interface (480 Mbit/s)</li>
<li>Isolation between CAN and USB</li>
<li>Industry standard DB9 connectors</li>
<li>Software support for Windows, macOS, and Linux
<ul>
<li>Cross-platform USB driver, command line interface, and APIs:
<ul>
<li>Python (via <a href="https://github.com/hardbyte/python-can/">python-can</a>)</li>
<li>C / C++</li>
<li>Rust</li>
</ul>
</li>
<li><a href="https://rbei-etas.github.io/busmaster/">ETAS BUSMASTER</a> support on Windows</li>
<li>SocketCAN support on Linux</li>
</ul>
</li>
</ul>
<h2><a class="header" href="#pin-assignments" id="pin-assignments">Pin Assignments</a></h2>
<table><thead><tr><th>Pin</th><th>Function</th><th>CAN 0 Only?</th></tr></thead><tbody>
<tr><td>1</td><td></td><td></td></tr>
<tr><td>2</td><td>CAN -</td><td></td></tr>
<tr><td>3</td><td>GND</td><td></td></tr>
<tr><td>4</td><td>SWCAN</td><td>Yes</td></tr>
<tr><td>5</td><td></td><td></td></tr>
<tr><td>6</td><td>GND</td><td></td></tr>
<tr><td>7</td><td>CAN +</td><td></td></tr>
<tr><td>8</td><td></td><td></td></tr>
<tr><td>9</td><td>+12 V In</td><td>Yes</td></tr>
</tbody></table>
<p>Note that single-wire CAN is only available on the CAN 0 connector.</p>
<h2><a class="header" href="#led-indicators" id="led-indicators">LED Indicators</a></h2>
<p>The device has four LEDs, two for each CAN channel. When powered on, the LEDs will blink in sequence. The LED indications during normal operations are shown here.</p>
<table><thead><tr><th>Color</th><th>State</th><th>Meaning</th></tr></thead><tbody>
<tr><td>Green</td><td>Solid</td><td>channel enabled, no activity</td></tr>
<tr><td>Green</td><td>Blinking</td><td>receive activity</td></tr>
<tr><td>Red</td><td>Solid</td><td>channel transmit enabled, no activity</td></tr>
<tr><td>Red</td><td>Blinking</td><td>transmit activity</td></tr>
</tbody></table>
<p>When using SocketCAN, each CAN interface can be identified by blinking the corresponding LEDs using <code>ethtool</code>. This is especially useful when using multiple devices.</p>
<pre><code>sudo ethtool --identify can0
</code></pre>
<h2><a class="header" href="#configuring-permissions-on-linux" id="configuring-permissions-on-linux">Configuring Permissions on Linux</a></h2>
<p>By default, root privileges are required to interact with the device. To allow other users to access the device, 
create a file at <code>/etc/udev/rules.d/99-cantact.rules</code>:</p>
<pre><code>SUBSYSTEM==&quot;usb&quot;, ATTRS{idVendor}==&quot;1d50&quot;, ATTRS{idProduct}==&quot;6070&quot;, MODE=&quot;0666&quot;
</code></pre>
<p>After creating the file, reload the udev rules:</p>
<pre><code>sudo udevadm control --reload-rules
sudo udevadm trigger
</code></pre>
<p>This will make the device accessible to all users. </p>
<h2><a class="header" href="#flashing-firmware" id="flashing-firmware">Flashing Firmware</a></h2>
<ol>
<li>Download the newest firmware binary <a href="https://github.com/linklayer/cantact-pro-fw/releases">from Github</a>.</li>
<li>To enter bootloader mode, hold down the button beside the USB connector while connecting the device
to your computer.</li>
</ol>
<p><img src="cantact-pro/enter-bootloader.jpg" alt="Holding the button to enter bootloader mode" /></p>
<p>The device will appear as a USB Mass Storage device with the label <code>CRP DISABLD</code>. Open the device. It should contain a single file: <code>firmware.bin</code>.</p>
<p><img src="cantact-pro/bootloader-folder.png" alt="Bootloader Mass Storage Device folder" /></p>
<ol start="3">
<li>Delete the <code>firmware.bin</code> file from the device. </li>
<li>Copy the downloaded <code>firmware.bin</code> file to the folder. </li>
<li>Eject the device </li>
<li>Unplug and reconnect the device. The firmware update is complete!</li>
</ol>
<h1><a class="header" href="#cantact" id="cantact">CANtact</a></h1>
<p><img src="cantact/cantact.jpg" alt="CANtact" /></p>
<p>The CANtact device is a single channel USB CAN interface. It can be used to connect to CAN bus systems, including cars, heavy duty vehicles, and industrial automation systems. CANtact works on Linux, OS X, and Windows.</p>
<p>With a CANtact and an OBD-II to DE9 cable, it is very easy to get onto the OBD-II CAN bus of any CAN enabled vehicle. </p>
<h2><a class="header" href="#getting-started-1" id="getting-started-1">Getting Started</a></h2>
<h3><a class="header" href="#connections--jumpers" id="connections--jumpers">Connections &amp; Jumpers</a></h3>
<p>CANtact uses a USB-B cable to interface with your computer. These cables are commonly used to connect printers as well.</p>
<p>The DE9 connector of the CANtact allows for two pin mappings for different use cases:</p>
<ul>
<li>Pins 7 (CAN high), 2 (CAN low), and 3 (ground) for standard CAN connections</li>
<li>Pins 3 (CAN high), 5 (CAN low), and 1 (ground) for use with an OBD-II to DB9 cable. This is compatible with the Sparkfun OBD-II cable.</li>
</ul>
<p>The pins can be selected using the jumpers on board.</p>
<p>The final jumper is for CAN termination. Place the jumper beside the &quot;CTE&quot; marking to place 120 ohms across CAN high and CAN low. This is commonly used in development, when you are only interfacing with a single CAN device. </p>
<h3><a class="header" href="#candlelight-firmware" id="candlelight-firmware">CandleLight Firmware</a></h3>
<p>To use the tools discussed in this book, you <strong>must ensure your CANtact is running the CandleLight firmware</strong>. The firmware can be <a href="https://github.com/linklayer/candleLight_fw/releases/download/cantact-8b2b2b4/gsusb_cantact_8b2b2b4.bin">downloaded from Github</a>.</p>
<p>After downloading, follow the steps in <a href="cantact/users-guide.html#updating-firmware">Updating Firmware</a> to perform the update.</p>
<h2><a class="header" href="#updating-firmware" id="updating-firmware">Updating Firmware</a></h2>
<p>The CANtact can be updated over USB. First, you will need to put the device into DFU mode by following these steps: </p>
<ol>
<li>Disconnect the USB cable from the CANtact</li>
<li>Connect the two &quot;BOOT&quot; pins</li>
</ol>
<p><img src="cantact/enter-boot.jpg" alt="Connecting the BOOT pins" /></p>
<ol start="3">
<li>While the pins are connected, plug the USB cable into the CANtact</li>
<li>The CANtact device is now in DFU mode</li>
</ol>
<p>The next steps depend on what OS you are using.</p>
<h3><a class="header" href="#windows" id="windows">Windows</a></h3>
<ol>
<li>Install the <a href="https://www.st.com/en/development-tools/stsw-stm32080.html">ST DfuSe Tool</a></li>
<li>Open the DfuSe tool</li>
<li>Click &quot;Choose...&quot; and select a DFU firmware file</li>
<li>Check the &quot;Verify after download&quot; box</li>
<li>Click Upgrade</li>
<li>Wait for the &quot;Verify successful !&quot; message at the bottom of the window.</li>
<li>Unplug the USB cable, disconnect the &quot;BOOT&quot; pins, and reconnect the USB cable. The device is now updated! </li>
</ol>
<h3><a class="header" href="#linux--macos" id="linux--macos">Linux &amp; macOS</a></h3>
<p>Flashing on Linux and macOS requires <code>dfu-util</code>.</p>
<p>On macOS, this can be installed from Brew: <code>brew install dfu-util</code>.</p>
<p>On Ubuntu, install dfu-util with: <code>sudo apt install dfu-util</code>.</p>
<p>Once <code>dfu-util</code> is installed, use it to flash the device:</p>
<pre><code>sudo dfu-util --dfuse-address -d 0483:df11 -c 1 -i 0 -a 0 -s 0x08000000 -D FIRMWARE_FILE.bin
</code></pre>
<p>Once this is complete, unplug the USB cable, disconnect the &quot;BOOT&quot; pins, and reconnect the USB cable. The device is now updated! </p>
<h1><a class="header" href="#software-tools" id="software-tools">Software Tools</a></h1>
<p>This section provides details on software tools with support for CANtact.
Some of these tools have been created specifically for CANtact, while others
support a variety of CAN interfaces.</p>
<h1><a class="header" href="#cantact-command-line-interface" id="cantact-command-line-interface">CANtact Command Line Interface</a></h1>
<p>The CANtact Command Line Interface (CLI) is a cross-platform tool with basic CAN functionality. 
These can be used to send and receive frames on Windows, macOS, and Linux.</p>
<h2><a class="header" href="#building-the-cli" id="building-the-cli">Building the CLI</a></h2>
<p>Building the CLI requires Rust, which can be installed using <a href="https://rustup.rs/">rustup</a>.</p>
<p>Once Rust is installed, install CANtact using <code>cargo</code>.</p>
<pre><code>cargo install cantact
</code></pre>
<h2><a class="header" href="#running-the-cli" id="running-the-cli">Running the CLI</a></h2>
<p>The CLI provides a single binary named <code>can</code>. To get help, run <code>can --help</code>.</p>
<h1><a class="header" href="#socketcan" id="socketcan">SocketCAN</a></h1>
<p>SocketCAN is supported out of the box. Just connect a CANtact to a Linux system and CAN interfaces will appear. For details on using SocketCAN devices, see the <a href="tools/../socketcan/socketcan.html">SocketCAN</a> section of this book.</p>
<h1><a class="header" href="#busmaster" id="busmaster">BUSMASTER</a></h1>
<p><a href="https://rbei-etas.github.io/busmaster/">ETAS BUSMASTER</a> is an open source tool software for simulating, analyzing, and testing CAN and LIN networks. BUSMASTER only supports Windows.</p>
<p>A <a href="https://github.com/linklayer/busmaster">fork</a> of BUSMASTER which implements CANtact support is available. 
A pre-built installer can be downloaded from the <a href="https://github.com/linklayer/busmaster/releases">releases page</a>.</p>
<h1><a class="header" href="#apis" id="apis">APIs</a></h1>
<p>The CANtact driver provides APIs to allow developers to build custom CAN-enabled applications.
Currently, API support exists for Rust, Python, C, and C++.</p>
<h1><a class="header" href="#rust" id="rust">Rust</a></h1>
<p>The CANtact driver can be used as a Rust library. The library is self-documenting, and documentation for the
latest version can always be found <a href="https://docs.rs/cantact-driver">on docs.rs</a>.</p>
<h1><a class="header" href="#python" id="python">Python</a></h1>
<p>A Python API is implemented by the CANtact driver. This can be used directly, but it is recommended to use 
the <code>python-can</code> library. Both components can be installed using <code>pip</code>:</p>
<pre><code>python3 -m pip -U pip
python3 -m pip install cantact git+https://github.com/ericevenchick/python-can@cantact
</code></pre>
<p>If no binary release exists for your platform, the driver can be built manually. 
For details, see the <a href="https://github.com/linklayer/cantact/#building-python-support">README</a>.</p>
<p>Once CANtact and <code>python-can</code> are installed, the bundled tools can be used. For example,
to log frames on CAN 0 at 500000 kbit/s:</p>
<pre><code>can_logger.py -i cantact -c 0 -b 500000
</code></pre>
<h2><a class="header" href="#examples" id="examples">Examples</a></h2>
<p>Examples of using the Python API directly and through <code>python-can</code> are 
<a href="https://github.com/linklayer/cantact/tree/master/driver/examples">available on Github</a>.</p>
<h1><a class="header" href="#c--c" id="c--c">C / C++</a></h1>
<p>The C / C++ API is a work in progress. This API is used to implement support for ETAS BUSMASTER on Windows. It currently only works on Windows.</p>
<p>Cross-platform support and documentation is a work in progress.</p>
<h1><a class="header" href="#socketcan-1" id="socketcan-1">SocketCAN</a></h1>
<p>SocketCAN is a collection of CAN drivers and networking tools for Linux. It allows interfacing with CAN bus devices in a similar fashion as other network devices. This allows for developers to write code that can support a variety of CAN bus interfaces, including CANtact. Unfortunately, SocketCAN only works on Linux. </p>
<p>This section provides an overview of common SocketCAN usage.</p>
<h1><a class="header" href="#getting-socketcan" id="getting-socketcan">Getting SocketCAN</a></h1>
<p>Specifics for installing SocketCAN will depend on your Linux distribution.</p>
<h2><a class="header" href="#ubuntu--debian" id="ubuntu--debian">Ubuntu &amp; Debian</a></h2>
<p>SocketCAN is built into the kernel provided with these systems. You will need to install the <code>can-utils</code> package to use the SocketCAN utilities (candump, cansend, etc...):</p>
<pre><code>sudo apt-get install can-utils
</code></pre>
<h1><a class="header" href="#hardware-devices" id="hardware-devices">Hardware Devices</a></h1>
<p>A hardware device is required to connect to a real CAN bus. When using hardware SocketCAN devices, each hardware CAN channel is given a number based on the order which the devices were connected in. The first device's first channel will be <code>can0</code>. </p>
<p>To set up a device with channel <code>can0</code> at a bitrate of 500000 kbps:</p>
<ol>
<li>Connect the device to a Linux computer</li>
<li>Set the device bitrate: </li>
</ol>
<pre><code>sudo ip link set can0 type can bitrate 500000
</code></pre>
<ol start="3">
<li>Bring the interface up:</li>
</ol>
<pre><code>sudo ip link set up can0
</code></pre>
<h1><a class="header" href="#virtual-devices" id="virtual-devices">Virtual Devices</a></h1>
<p>Virtual CAN devices, or vcan devices, can be used to simulate a CAN bus without any hardware. This is useful for simulation, testing, and bridging. It also lets you try out can-utils without having an actual CAN device. </p>
<p>To create a vcan device run: </p>
<pre><code>sudo ip link add name vcan0 type vcan
</code></pre>
<p>Once created, the device can be used like a hardware device. It does not require a bitrate setting, but the interface must be enabled before use:</p>
<pre><code>sudo ip link set up vcan0
</code></pre>
<h1><a class="header" href="#utilities" id="utilities">Utilities</a></h1>
<p>The SocketCAN utilities provide simple command-line tools for interacting with CAN buses.</p>
<h2><a class="header" href="#candump" id="candump">candump</a></h2>
<p>candump displays messages on the specified CAN bus. To show all traffic in real time on device can0:</p>
<pre><code>candump can0
</code></pre>
<p>The displayed messages can be filtered using a mask and identifier. Two filter types are available: </p>
<ul>
<li><code>[can_id]:[can_mask]</code> matches when <code>[received_can_id] &amp; [can_mask] == [can_id] &amp; [mask]</code></li>
<li><code>[can_id]~[can_mask]</code> matches when <code>[received_can_id] &amp; [can_mask] != [can_id] &amp; [mask]</code></li>
</ul>
<h3><a class="header" href="#examples-1" id="examples-1">Examples</a></h3>
<p>Only show messages with ID 0x123 on vcan0:</p>
<pre><code>candump vcan0,0x123:0x7FF
</code></pre>
<p>Only show messages with ID 0x123 or ID 0x456 on can3:</p>
<pre><code>candump can3,0x123:0x7FF,0x456:0x7FF  
</code></pre>
<h2><a class="header" href="#cansend" id="cansend">cansend</a></h2>
<p>cansend sends a single CAN frame on the bus using the specified identifier and data bytes. For example:</p>
<pre><code>cansend can0 123#1122334455667788
</code></pre>
<p>This sends a message on interface <code>can0</code> with identifier <code>0x123</code> and data bytes <code>[0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88]</code>. This tool assumes all values (ID and data) are provided in hexadecimal. </p>
<h2><a class="header" href="#cangen" id="cangen">cangen</a></h2>
<p>cangen can generate random CAN data, which can be useful for testing. Run <code>cangen</code> for detailed usage information. </p>
<h2><a class="header" href="#cansniffer" id="cansniffer">cansniffer</a></h2>
<p>cansniffer displays frames that are currently on the bus, but filters out frames with data that is not changing. This is very useful for reverse engineering CAN bus systems. Run <code>cansniffer</code> for detailed usage information.</p>
<h1><a class="header" href="#isotp" id="isotp">ISOTP</a></h1>
<p>The can-utils package contains tools for working with ISOTP. However, the kernel ISOTP support needed by these tools is not available by default on most systems. This results in an <code>Protocol not supported</code> error when running ISOTP tools.</p>
<p>The can-isotp kernel module and build instructions are available <a href="https://github.com/hartkopp/can-isotp">on Github</a></p>
<h2><a class="header" href="#testing-isotp-driver" id="testing-isotp-driver">Testing ISOTP Driver</a></h2>
<p>To use ISOTP, you will need two physically connected CAN channels (or gatewayed virtual CAN devices) to send and receive data. Once set up, start <code>isotprecv</code>:</p>
<pre><code>isotprecv -s456 -d123 can1
</code></pre>
<p>In another terminal, run <code>isotpsend</code> to send ISOTP data. This tool reads from standard input, so <code>echo</code> is used to provided data as a sequence of space seperated hexidecimal bytes:</p>
<pre><code>echo &quot;de ad be ef de ad be ef aa bb cc dd&quot; | isotpsend -s123 -d456 can0 
</code></pre>
<p>The data should appear in <code>isotprecv</code>.</p>
<h1><a class="header" href="#hacking" id="hacking">Hacking</a></h1>
<p>Want to hack on CANtact? Great!</p>
<p>All CANtact related development takes place on Github. If you find a bug, please file an issue there. There are several relevant repositories containing code and design files.</p>
<h2><a class="header" href="#cantact-cli-and-driver" id="cantact-cli-and-driver">CANtact CLI and Driver</a></h2>
<p>The CANtact CLI and Driver are written in Rust. The repository can be found <a href="https://github.com/linklayer/cantact">on Github</a>.</p>
<h2><a class="header" href="#cantact-pro" id="cantact-pro">CANtact Pro</a></h2>
<p>Design files and firmware for CANtact Pro:</p>
<ul>
<li><a href="https://github.com/linklayer/cantact-pro-hw">CANtact Pro Hardware</a></li>
<li><a href="https://github.com/linklayer/cantact-pro-fw">CANtact Pro Firmware</a></li>
</ul>
<h3><a class="header" href="#hardware" id="hardware">Hardware</a></h3>
<p>CANtact Pro is designed using the open source <a href="https://kicad-pcb.org/">KiCAD EDA</a> suite.</p>
<h3><a class="header" href="#firmware" id="firmware">Firmware</a></h3>
<p>The CANtact Pro is powered by an NXP LPC546xx series microcontroller (specifically, the <a href="https://www.nxp.com/products/processors-and-microcontrollers/arm-microcontrollers/general-purpose-mcus/lpc54000-cortex-m4-/power-efficient-microcontrollers-mcus-with-advanced-peripherals-based-on-arm-cortex-m4-core:LPC546XX?fpsp=1&amp;tab=Documentation_Tab">LPC54616J512BD100</a>). </p>
<p>NXP provides their <a href="https://www.nxp.com/design/software/development-software/mcuxpresso-software-and-tools/mcuxpresso-integrated-development-environment-ide:MCUXpresso-IDE">MCUXpresso IDE</a>
free of charge, which can be used to develop and debug firmware for the device.</p>
<h1><a class="header" href="#support" id="support">Support</a></h1>
<p>Need help with CANtact?</p>
<p>If your hardware appears to be defective, please contact us at <a href="mailto:hello@linklayer.com">hello@linklayer.com</a>.</p>
<p>If you have found a bug, please leave a ticket on the relevant Github repository. For a full list, see <a href="support/../hacking/hacking.html">Hacking</a>.</p>
<p>Need commercial support? Developing custom CAN tooling? Contact us: <a href="mailto:hello@linklayer.com">hello@linklayer.com</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
